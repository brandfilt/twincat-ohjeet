#+TITLE: TwinCat 3 Opas
#+STARTUP: showall
* Mikä TwinCat?
TwinCat (The Windows Control and Automation Technology) on Beckhoffin
automaatiojärjestelmien ydin.

Se on PC-pohjainen ohjelmisto, joka muuttaa minkä tahansaPC:n tehokkaaksi automaatiojärjestelmien ohjaimeksi.

TwinCat 3 on ohjelmiston uusin versio, jonka avulla automaatiohjelmointia
voidaan tehdä IEC 61131-3 standardin mukaisten kielten lisäksi C ja C++
ohjelmointikielillä. Twincat 3 on rakennettu Microsoftin Visual Studio
ohjelmointiympäristön päälle.
* Asennus ja ensimmäinen käynnistys
** Vaatimukset
- Windows XP tai uudempi
- Prosessori 1.6Ghz
- 2GB RAM
- 3GB kiintolevytilaa
** Lisenssi
TwinCat 3 lisenssi on täysin ilmainen mutta sen lisenssi on luotava uudelleen 7
päivän välein. Lisenssin aktivointi tapahtuu TwinCat projektin SYSTEM kohdan alla
olevasta License kohdasta.
#+ATTR_HTML: width="300"
#+ATTR_ORG: :width 300
[[file:Lisenssi01.png]]
Kehityskoneen lisenssin voi aktivoida klikkaamalla "Activate 7 Days Trial
License..." ja täyttämällä turvallisuus koodin.
** Virtuaalikoneet
Koska TwinCat ajaa PLC emulaatiota PC:llä saattaa se aiheuttaa ongelmia,
jos samaan aikaan on käytössä muita virtuaalikoineita. TwinCat projektia ei tässä
esimerkiksi pysty asettamaan Run-moodiin, jos samaan aikaan PC:llä on käynnissä VirtualBox.
** Core isolation
TwinCat projekti voidaan ajaa eristettynä yhdellä prosessorin ytimellä Core
Isolation ominaisuuden avulla. Core Isolation löytyy projektin SYSTEM osion alta.
* Ensimmäinen PLC projekti
** Uusi projekti
Uusi PLC projekti aloitetaan valitsemalla Visual Studio File valikosta New
Project.

#+ATTR_HTML: :width="300px"
#+ATTR_ORG: :width 50
[[file:kuvat/UusiProjekti01.png]]
Sen jälkeen valitaan Template valikosta TwinCAT Project XAE, annetaan
projektille nimi ja sijainti ja luodaan projekti klikkaamalla OK.

#+ATTR_HTML: width="300"
#+ATTR_ORG: :width 300
[[file:kuvat/UusiProjekti03.png]]
** Asetukset
Ennen kuin aletaan ohjelmoimaan, kannatta projektin asetukset ja lisenssi käydä lävitse.
** PLC projekti
Nyt kun TwinCat projekti on luotu, täytyy siihen vielä lisästä PLC projekti,
jotta päästään ohjelmoimaan. Tämä tapahtuu klikkaamalla hiiren oikealla
puunäkymän kohtaa PLC, ja valitsemalla Add New Item.
[[file:kuvat/LisaaPLCProjekti01.png]]

Avautuvast ikkunasta valitaan projektityypiksi Standard PLC Project, annetaan projektille nimi ja
klikataan OK.
[[file:kuvat/PLCProjekti02.png]]

Projektin puunäkymään PLC-kohdan alle ilmestyy luotu projekti tiedostoineen.
[[file:kuvat/PLCProjektiSisalto01.png]]
*** Kansiorakenne
- External Types
- References
- DUTs
- GVL
  Globaalien muuttujien määrittely. Möyhemmin näihin
  voidaan mäpätä tulot ja lähdöt.
- POU
  Ohjelmat joita PLCllä ajetaan.
- VISUs
*** Ohjelmointi
TwinCat 3 tukee kaikkia IEC 61131-3 standardin mukaisia ohjelmointimenetelmiä,
eli LD (Ladder diagram), FBD (Function Block Diagram), ST (Structured Text), IL
(Instruction List) ja SFC (Sequanteial Function Chart). Tässä ohjeessa käydään
läpi lyhyesti LD, FBD ja ST ohjelmointimenetelmien käyttö TwinCat 3:ssa.
**** Ladder diagram -ohjelmointi
**** Fuction Block Diagram -ohjelmointi
**** Structured Text -ohjelmointi
** Globaalit muuttujat
Glo
** Projektin ajaminen TwinCat runtimella
- Aktivoi konfiguraatio
** Ohjelman debuggaus ajon aikana
** I/O mäppäys
*** EtherCat laitteiden lisääminen
*** Terminaalimoduulien lisääminen
* HMI käyttöliittymä
** Eri toteutustavat
** Web toteutuksen vaiheet
** UI mäppäys muuttujiin
* Etäyhteys koulun laitteistoon

|-----+---------------+-------|
| CPU | Arkkitehtuuri | Muuta |
|-----+---------------+-------|
| Häh | Jotain        | Ehkä  |
|     |               |       |
|     |               |       |

* Lähteet
** https://download.beckhoff.com/download/document/catalog/TwinCAT_3_Booklet.pdf
